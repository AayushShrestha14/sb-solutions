<databaseChangeLog
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

  <!-- Enhance change set start-->
  <changeSet id="61-create-loan-config-enhance" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <tableExists tableName="loan_config_enhance"/>
      </not>
    </preConditions>

    <createTable tableName="loan_config_enhance">
      <column name="loan_config_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
      <column name="enhance_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="61-create-loan-config-enhance-loan-config-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_enhance" foreignKeyName="fk_loan_config_enhance_loan_config_id"/>
      </not>
    </preConditions>

    <addForeignKeyConstraint baseColumnNames="loan_config_id"
      baseTableName="loan_config_enhance"
      constraintName="fk_loan_config_enhance_loan_config_id"
      onDelete="CASCADE"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="loan_config"/>
  </changeSet>

  <changeSet id="61-create-loan-config-enhance-enhance-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_enhance" foreignKeyName="fk_loan_config_enhance_enhance_id"/>
      </not>
    </preConditions>
    <addForeignKeyConstraint baseColumnNames="enhance_id"
      baseTableName="loan_config_enhance"
      constraintName="fk_loan_config_enhance_enhance_id"
      onDelete="RESTRICT"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="document"/>
  </changeSet>
  <!-- Enhance change set end-->

  <!-- Partial Settlement change set start-->
  <changeSet id="61-create-loan-config-partial-settlement" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <tableExists tableName="loan_config_partial_settlement"/>
      </not>
    </preConditions>

    <createTable tableName="loan_config_partial_settlement">
      <column name="loan_config_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
      <column name="partial_settlement_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="61-create-loan-config-partial-settlement-loan-config-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_partial_settlement" foreignKeyName="fk_loan_config_partial_settlement_loan_config_id"/>
      </not>
    </preConditions>

    <addForeignKeyConstraint baseColumnNames="loan_config_id"
      baseTableName="loan_config_partial_settlement"
      constraintName="fk_loan_config_partial_settlement_loan_config_id"
      onDelete="CASCADE"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="loan_config"/>
  </changeSet>

  <changeSet id="61-create-loan-config-partial-settlement-partial-settlement-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_partial_settlement" foreignKeyName="fk_loan_config_partial_settlement_partial_settlement_id"/>
      </not>
    </preConditions>
    <addForeignKeyConstraint baseColumnNames="partial_settlement_id"
      baseTableName="loan_config_partial_settlement"
      constraintName="fk_loan_config_partial_settlement_partial_settlement_id"
      onDelete="RESTRICT"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="document"/>
  </changeSet>
  <!-- Partial Settlement change set end-->

  <!-- Full Settlement change set start-->
  <changeSet id="61-create-loan-config-full-settlement" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <tableExists tableName="loan_config_full_settlement"/>
      </not>
    </preConditions>

    <createTable tableName="loan_config_full_settlement">
      <column name="loan_config_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
      <column name="full_settlement_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="61-create-loan-config-full-settlement-loan-config-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_full_settlement" foreignKeyName="fk_loan_config_full_settlement_loan_config_id"/>
      </not>
    </preConditions>

    <addForeignKeyConstraint baseColumnNames="loan_config_id"
      baseTableName="loan_config_full_settlement"
      constraintName="fk_loan_config_full_settlement_loan_config_id"
      onDelete="CASCADE"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="loan_config"/>
  </changeSet>

  <changeSet id="61-create-loan-config-full-settlement-full-settlement-id-constraint" author="elvin">
    <preConditions onFail="MARK_RAN">
      <not>
        <foreignKeyConstraintExists foreignKeyTableName="loan_config_full_settlement" foreignKeyName="fk_loan_config_full_settlement_full_settlement_id"/>
      </not>
    </preConditions>
    <addForeignKeyConstraint baseColumnNames="full_settlement_id"
      baseTableName="loan_config_full_settlement"
      constraintName="fk_loan_config_full_settlement_full_settlement_id"
      onDelete="RESTRICT"
      onUpdate="CASCADE"
      referencedColumnNames="id"
      referencedTableName="document"/>
  </changeSet>
  <!-- Full Settlement change set end-->

</databaseChangeLog>
